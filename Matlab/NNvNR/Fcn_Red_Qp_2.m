function [y1] = Fcn_Red_Qp_2(x1)
%FCN_RED_QP_2 neural network simulation function.
%
% Auto-generated by MATLAB, 06-Sep-2021 10:49:56.
% 
% [y1] = Fcn_Red_Qp_2(x1) takes these arguments:
%   x = 2xQ matrix, input #1
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-116.063060960018;-116.229534617895];
x1_step1.gain = [0.00861222819736077;0.00860324037730651];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.7379817990516759352;-2.8129739057943088376;4.996266889935554012;3.294633407833181149;3.7946046413007072928;2.1327015041745256418;-1.2105049010473964977;-0.97077883677216325609;-0.87126015709379756036;1.5532843949816690365;-0.86819271727189861743;-0.11160895578560257879;1.352104789621902059;-2.9241730614819823053;1.9435881008363540268;1.4239582524259302154;-4.2845072475627929975;-3.140948603689558194;-3.1867253904990664459;7.5580194296869223081];
IW1_1 = [-5.0930896782626042807 2.1869051046971734742;1.6650369913576041903 -4.3743647742289146763;-3.5863711894045069428 -4.1093526348333870857;-4.6738051678747503104 1.7707791092213631678;-4.3379875603132287409 -4.0420259824875577337;-3.4858001071166819784 2.1006553706248052293;1.5649162681368653516 2.1184069391708102437;3.4937751930224698604 1.9592418987545390241;2.9993012343823473032 -5.4161325011042791289;-3.2425974452259311853 4.3591399026847250653;0.01014535445031303218 -3.6562621230262308814;4.4755664343818795103 -1.4780522888198572851;2.5795694015052319514 3.3886885434208995349;-2.8054625286843353216 -4.4986960801936435317;0.83486456573020884075 1.8039384975482017914;3.0875576478116539825 -2.7019579085734766188;-8.0665458626510311291 -0.5980238401852189245;-3.3787942485031181583 3.364964686730676835;-2.5191316986287897173 1.8678744057609604212;6.1108189049279806326 2.0130656404897568912];

% Layer 2
b2 = [1.4314820867734383558;-0.64538432979718440841;5.9896291237673509045;3.0598334024416078414;4.5346548294640482979;2.3422356068994800715;-2.4644441714337830263;-0.45479470188539289355;-0.70354985222502774977;-0.018613240828877854888;1.2641489437577146937;-0.075249389687510520597;0.66283869798070260693;0.72103092870817420135;0.72876314504078687495;-1.1808115606474571813;-1.5556691682483245742;0.99281545834910078785;1.788411756616030468;-1.8340816383096882891];
LW2_1 = [0.74414240591507319067 -0.10491017275963396282 0.4869853998570737863 0.35477957344342497814 -2.8338639709591091354 0.14259811511543846185 0.096305982271230744507 -0.64574858442610150178 -0.32371332818657228003 0.88490952904988262606 0.58677106577615933958 -0.51982606506795880907 -1.922469424298152374 0.60326721256643112135 0.50471139645584850442 -1.3790296087853353146 -0.47954816074085904187 0.8621478433448399592 -0.69767593304577601998 0.2485570305274349967;0.37357613686373003503 0.2919022233038962022 1.1918273190798152061 -0.60898987437852591942 1.8906575660524844729 0.31801280492227196328 1.5978560986938936672 -0.67079616755783511017 0.58131544733589890495 0.38308886465661173837 0.62792900726198153105 0.059803896954963658983 -1.8012768177066409425 -0.72276641188912560398 -2.4077527690721733933 0.98618217611187963811 -0.42630149851482523893 1.2337792281270900663 -1.1499127859822417808 -0.92900232759650225312;3.033035297005612474 4.0840338333974486318 -0.24671700736857990477 -3.9360736233953326213 -0.57895843664535640016 -1.9141556462413988893 1.2332514604960072013 -0.21840406128023104326 -0.17561966140223497779 0.98270354367657353212 -2.1860884321665583485 -0.61039077847919820385 -1.6636674594416045458 2.0290175323863928192 -0.067424487535747298916 0.90823806408963037029 -0.83914139000894205633 0.065028447754961166138 -0.36279321280588278098 0.61462179451690446275;0.77896702956606456159 -1.0478848409047714085 1.7218304165807836181 1.4743280518459733752 -0.11438969450645644632 -1.4285125521644597146 3.0336445068446251661 2.4577230962538045844 -0.28748742283920558638 -0.25014217244307268562 2.1663747380015951904 -0.020172903317600725942 -3.4105467970318068538 -2.0488263333128027277 1.3570909361096548107 -1.5974408313316104113 1.0036126528994764318 7.0759354378213288328 -1.452817850155293522 0.70068360859294609444;-0.75285755614230354116 -0.24888642565985030775 0.19833476191470653105 0.075265133056795371913 -0.62726355713551762427 -0.70340752796699823612 -0.10919560608333515883 -0.076980443734204137551 -0.25569139402424306828 -0.28448245282935685774 0.84087654637115616385 -0.089123211637508789607 -0.31043053869481851414 -2.7066257076602973086 -4.1780315017119216137 -0.64377665661683391995 0.28708923467541042074 0.038177335894224721791 0.57363236381860849278 -1.7403759280027772949;-0.21539672395720638187 -0.22834885913197555674 1.620928003904131165 0.44916008358051284777 1.3450065006814133639 0.38442745155422158865 2.3571527765457189751 0.47588604903892561815 1.6768290939895853509 0.57888701699159528236 0.94707201211545399833 0.3947027790217171872 2.9249460555962416564 3.0015545537983094881 -2.2445329750233864452 -2.3819850426637358964 2.6858828238367267183 0.29547067296954193649 -1.8441771987508945863 1.6372420768800639568;0.35004248784116731574 -0.07449313209154063975 0.85457231573568348537 -0.28828042096959005658 0.21205170921833008113 1.2908538353708098878 -2.052900737622953109 -0.58235270775434599955 0.34339173446756898755 -0.4038318991823866555 -1.5640893138891611702 0.085981241448963963148 -0.18701026362737854791 -0.38790118559555208932 -0.18718375934618719514 -2.1809653994591151616 -0.24505614869932879074 -1.4113603689301124078 -3.6295919820138777823 -1.7447263866594695525;0.28614624747647510183 0.072447835911557442734 0.27289981182826922312 0.77890076678432806911 -0.56976712891986491805 -0.24540445475261485342 0.7702569617661099155 0.92311551973193195497 -1.123603555746599536 -0.38603136319101072349 -0.44307130302342656591 0.052271651909252314638 -0.26774394172503851452 -1.3501992322817204517 0.44650779706027055038 0.43949101831952314123 -0.15777968739258591002 -0.39784544505630314859 0.33675905673756689751 -0.33301484116457880091;-0.85032869218328066552 0.08786191724322946206 1.3096374696909036661 1.7364565580750910279 0.21089776827315342977 0.14460367686980710178 0.44534645859041727123 -0.33176457151401772538 -0.31716126156200580288 0.64042592590176772305 0.31809617978717064091 -0.20387712098959939744 -0.59724901228425353317 -0.39593593437497359711 0.070569674317391486995 -0.84004816000820514699 0.19970009478048192375 -0.32124666199796209076 0.47580236175195939063 -0.47783107975839739234;0.066462782993946811771 0.43222062729360077871 0.18468350460132745838 0.52141108763522636682 -0.071768755162709113593 0.18869646586808741517 0.12777311416189471305 -0.27284596907181074554 -0.52529624895489623881 0.020455018881387860424 -0.0013033429154592282573 0.34905172791517891095 0.18031921707761972007 1.1220142505635601893 -1.0462896333829958539 0.9948927444442385859 -0.063641236259777120288 0.011793804302049872706 0.19794648600965136787 -0.95234469859315118434;0.26303123937867955995 0.77746281168375341863 0.45089931674865274536 -0.073627475672059544687 0.66279773212191495091 0.61062804853810814798 -0.55620444386481804333 0.049899272346358436447 0.23095510914699432514 -1.6065164344194955426 -1.6901207335237569129 -2.1665329495041349972 -0.52367101251296277464 1.1119439098727006421 -1.5548796037654324387 1.8041242113931326152 -0.95201326767077087965 -0.2004644029039600317 2.8449402713662337305 -0.27974125938226573895;-2.1981363126856483525 1.4593605476754492045 -0.053292112681850717371 -1.0072480407716239981 -0.97693374576696756506 -0.5716541451296461851 0.31428169990652871091 -1.2866698048598683712 0.29212294466106086821 0.028121950218480160771 -0.72992527166303688979 -0.028583127766069218317 0.9826824697919785967 0.58371891800086939117 -3.3635173733821130959 -0.04038106168098909432 -0.15411250156070760431 -0.2598103705402361463 -0.47249335057803970583 0.6891069918975288866;0.57298294275086081306 -0.055702820076071982158 -1.1243767018087256204 -0.34152985751942616099 -0.77678998289757039686 -0.15104873150359221512 -0.92366655779136996873 0.0054544909880129806637 0.74348627080833806779 0.18525630959638447748 1.4813270309564294802 -0.22759727562842610449 1.1831663736890454253 -2.0343674016842663299 -0.15191779895821380664 -0.40925599587914968103 0.63932131126453517478 -0.31038078995066881172 0.41694857174133026501 0.83740790678061105545;0.79605304076923322221 0.51493241343926265952 2.2570417317312587713 0.081518074008747748449 -1.0119184822952658198 -1.3863609337316480374 1.0156460647614660164 -0.38840968051460966759 0.31397900732854838735 0.97877348587946111369 0.14885440971325888948 0.46519083468290434169 1.3561731527545339837 0.49569748234880367521 -2.2531977039940920271 0.9573583737824932216 -0.18174258711721086312 -0.20319855306752157564 -1.5735369928201758949 -0.1389058083141562483;-0.57805360532065364065 0.032190322492619459493 -1.0728453205134096393 0.20651074026906857117 0.016281029227844700386 0.36066021486353450065 0.077416525471733915742 -0.47292950347809337153 0.080642789971803435778 0.6054455578785724601 -0.25006415160396716635 -0.13445558386230049841 0.70800664684423875173 0.047250504223479108945 1.2020011818163229833 0.65464603342872373926 -0.16394187419635172787 -0.58015099167031547456 0.47860692823203837554 0.16386457493113898432;-0.20599388787570382942 0.17433671392077171314 0.78825354067401465219 -0.023703085719259976705 -0.66349531827465968448 0.29944780802152670685 0.35162665422266409232 0.81258082977637879907 0.36930098435454172812 0.050880718036862740417 0.49747033711383337184 -1.1011313506364175385 -0.42604897503989908047 -1.6595628188520155089 -0.37951055410513417909 0.8121829761355178201 0.4630693222874128212 -0.042265929443112477959 0.22290329894805444022 0.14759810333649969749;-0.21953158342809625525 0.61901607110043221915 -0.70548314762662411859 -0.07804598187588210334 0.077053100877140970337 -0.35250973462120627211 -0.68006144580774130493 -1.1713317672955569915 -0.14718210998395833689 -0.68268233200785977122 -0.019748496110013537275 0.0052660487005757976309 -0.50375035662471145947 0.58026593213608501642 0.75789492117706491747 0.29060092070148135779 0.51490306811994934755 0.98066007319016845756 -1.1686990373295085277 -0.56002757867955699211;1.0267864657787491023 0.090841009859674637372 1.1525448516935219434 -0.1906627687604141308 2.1575399723499639748 -0.84507917884557837152 -0.59917596412249973792 0.016467846096901696262 0.93892033354786141874 0.41020025678399785196 0.48018462736399020185 0.37559369478252824237 -0.56860039257414385361 0.87247132842418062548 -0.43253465046469163902 1.2383524575176378946 0.21834496795009170067 -0.12664110213721402332 -0.17326058643422226346 -0.61904896164141842707;0.37765169698882922189 -0.49399043309341617025 0.20001959843910385728 0.32990126605511399527 -0.23295370256211933579 0.39473755623414413796 -0.11075992719208149762 0.81558125732871433744 0.10015255551331132822 -0.48538719627715193328 0.89469303896711060986 0.44565165582886101525 0.30753437781707831933 0.32154137502750018696 -0.013052432277508838054 1.2085076699620773688 -1.152881808590113355 -0.96138505550385666698 0.032495205493779634465 -0.16834181985641882839;-0.64429717929800534026 0.57939125443096384238 0.10691430925016053022 -0.30302678104007041426 -0.56444629906305232581 -0.22093529738532274864 0.51226760545002314462 -0.27791468731160651195 0.4033867603230060217 -0.28349992214719554884 0.066533614091545137392 -0.29073759019125267056 -0.32910209175707838547 -0.094002500761177207322 -0.32316173813342208287 -0.23650603714430395996 0.33555815943464145645 0.51894531549781697244 0.68853629527132520494 -0.21025384945789912794];

% Layer 3
b3 = 2.1258366811756124193;
LW3_2 = [-1.3447261378992947378 0.70534200346517095248 2.7617458926855360524 1.6084709608694489624 2.2966191659854993112 1.1521529273968178497 -1.4738253181512301904 0.96916553858150933376 1.0745530592773890888 1.4442422418355709279 1.5097666768288324768 2.7430873004724758424 1.3876803761869449527 -1.3211969858364096542 -1.8020246586706496483 -2.3403855144267713406 -0.80297594549319517565 -1.1780781134600850635 -0.036654317119945468983 -3.14584623478995562];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.045793148506551;
y1_step1.xoffset = 0.02353331325223;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = repmat(b3,1,Q) + LW3_2*a2;

% Output 1
y1 = mapminmax_reverse(a3,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
