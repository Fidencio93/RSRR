function [y1] = Fcn_Red_Qr_2(x1)
%FCN_RED_QR_2 neural network simulation function.
%
% Auto-generated by MATLAB, 06-Sep-2021 10:49:56.
% 
% [y1] = Fcn_Red_Qr_2(x1) takes these arguments:
%   x = 2xQ matrix, input #1
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-116.063060960018;-116.229534617895];
x1_step1.gain = [0.00861222819736077;0.00860324037730651];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.5688564965709064225;-5.7687059082994736059;-4.8006775443155698113;-4.3236117527223942858;3.6374338236183101358;-3.3361753294995648567;1.9932238505289809893;1.0260524438602984798;-1.4265286885043899634;-0.26745268228088486806;0.36712375173524708361;1.1187993727404939026;-2.7043312439245301704;-3.0537848666042184398;-2.2960058973499855028;3.1046641503389045269;-3.6840035631555756446;4.4494080840570440216;5.1568675355944018079;-6.0138905277330589882];
IW1_1 = [-3.8829035718087405726 -4.365937233038468257;5.8764632382001211752 -1.6447968598277848962;5.9821052761574478041 -1.6270648733277557341;3.3818136832629184241 -4.7131937528060108278;-3.2173059951961255898 5.3560701930163707729;4.9717993112081773077 -3.6123909423091657978;-5.5780937921415283398 2.8942930886107247623;-4.2222311161037993088 -3.3875116153323125978;5.9390189053270523445 -0.3822649638261359506;3.9860114353066342652 -4.6892155361565794891;5.5569056704629886667 0.44977289327775327177;4.7315503636608795546 -3.5413805648808120985;-5.0396132169805607504 3.3071765940160995356;-1.3289784141400582396 5.8917014307211799107;-3.7508900987882505262 -4.384458859650443685;5.6793155593961683891 1.244278922415409161;-4.2636748747152397598 1.8914927575576256924;1.9247311440430987517 6.1253003071459692919;5.6133171351868851318 3.285448647867684091;-2.8193569097548567548 -5.6439656048369677421];

% Layer 2
b2 = [1.7980719454188864859;1.0808638802155667857;1.2583942585090124311;-1.0688040840336030524;-0.84396293739327021832;-0.78909260196465624837;0.50442232410887855032;-0.51718670667747856928;-0.12652918007862284933;-0.0028928353506011395511;0.10627396386746891521;-0.42353068014569622557;-0.55620757784814267577;-0.69228483053568656835;-0.93751193106658103904;1.0831074698741567364;-1.2735187299459662658;-1.3563368074724326817;-1.6353377734918619346;-1.7176436146889917378];
LW2_1 = [0.021608588477033084663 0.014308041386786702134 -0.045767075825568014069 0.4287614487596284607 0.50659152967705745052 -0.47490643105395202728 -0.045539143328794023935 -0.28068289694000836398 0.803063643530101956 0.047306827220888324204 0.055326494492277202009 0.055503231902016350596 0.40784335147321776338 1.2468776651555353308 1.1090680568763697789 -1.1210138316647300094 0.63319483966784173568 0.53556107021811694135 0.17560479564813091802 -0.16790868296454639075;-0.78279269328347722556 -0.097414538780946052787 -0.26734804056023048213 0.44535132210193173474 0.20230415602828213939 0.23097032429407610143 0.30092963287885654555 0.085733303636176566576 0.10805025794625927604 -0.43223188614463159407 -0.73780534280519172174 -0.48630255961765461725 0.11853298074026480391 -0.089071603156355511066 -0.26556038929242342661 -0.25402436650599813373 -1.1463499393004945581 0.52263382363526245111 -0.46666222240867560878 0.37925090368911335004;-0.16069633970696137193 -0.6942309689225958369 0.20328911607056801558 0.27423233504239685754 -0.12489847427155774395 -0.53957733117489958818 0.1306136692021089285 0.27816096763177622364 0.4699543938157983991 -0.60915697372097687978 -0.19844796288497451586 0.29553500972331953056 -0.099593445836338875821 0.33399692169643779849 0.56144529811615440096 0.21046398187138848357 0.21998939610337434059 -0.065725962066038784437 0.61343978891220385385 0.17930925993320900869;0.27816155452432250739 -0.27249648187625036266 -0.20393810700475789588 -0.25615500009470082432 -0.54955315448971608916 -0.016987394440429785802 -0.20046029764577158461 -0.19014208002079938109 -0.07421053466008353805 0.8236248264193607449 0.68837315833748291549 0.54796789682805213673 -0.51138768279155388807 -0.4756609261219521545 0.16016262105297265905 0.69171667542048798083 0.57595067479763595308 0.16768797651374769964 -0.074520815579119631389 0.12308156697197455975;0.23302276609075328606 -0.45739888290610430932 0.010936852070110627752 -0.90974827134720526178 0.20484313176466051321 -0.17419362305725447082 -0.87201608345218217799 -0.17088962605982055409 0.25909571993937846601 0.39087646041418844245 0.018134412901649844124 -0.045780195864661352156 -0.48792080652971353549 0.073099575145851705682 -0.75411880219583060647 0.23013583899780401532 0.33317183420103330116 -0.16089084914112047886 0.26700610456417916971 -0.022461642149940900387;0.57165145196827027441 0.49450298660449243382 0.4969233296264759514 -0.35584665816106192393 0.068476915279545233495 0.49837146236310109204 0.017191381313899637556 -0.30021234243929190155 0.32499552356403660358 -0.067041844759669372289 -0.51263741855661215663 0.09375674499205768897 0.25189368592166094807 0.13117959385747354761 0.22908790466003020603 -0.48592155540869746977 -0.46001501448127496419 -0.37493680050930533465 -0.35123729553362165179 0.39699942195887805152;-0.13542081136562858501 -0.38723026484120287583 0.25257261034807293454 0.32895670915347491325 -0.43389536269938649982 0.4885070997275514082 0.73542305977623978475 -0.11259707289526441065 -0.92861321940965646515 0.83684293938848330896 0.090919184590761398246 0.43908703494396172928 -0.66442211207931067829 -0.86966086809096798671 0.70485912116249127557 0.71654358965621012256 0.072027392100414991405 -0.10931005289566199379 -0.0015720252125219773449 0.20694424185483040191;0.16819768470592977305 0.42718961286498713381 0.44048347283562033772 -0.66525134909385363891 0.57184196731131287095 -0.040394811139517025622 0.5366417875221467515 -0.062649970151817960251 0.4935439192164656208 0.39766037107274593287 0.17999841671282620914 -0.10704946120301203627 -0.52916506858698741933 -0.34732788596108621348 -0.11447833217459855992 0.20954094485731633579 -0.48130518799489518944 0.018259361788349370154 0.031488219806152281666 0.17943247539730605711;-0.014698730904534069303 0.59444121062148735923 0.09313560737958893887 -0.038539266693165062649 -0.43802183639269920423 0.39886081806821133133 -0.37486281907401985958 -0.38114931278341684928 0.2370862293284255462 0.34316400202628505323 -0.70497981406456422526 -0.23212995484348178388 0.23912931163989442629 -0.080930468101058847252 -0.76388736416717939459 0.41014418080473635797 0.5971482323267387482 0.064845698738032336861 -0.17696727529744407659 -0.49148037056010052126;-0.56963898777610022517 0.083621734235430539295 -0.049628854636327532357 -0.29959546388336183442 -0.42604112843080216289 -0.40464372028791395497 -0.22053561625360201814 0.10745390657584233396 -0.10017316748178643759 -0.64833338893162273386 0.47844207071131011899 0.36317442957584572527 -0.30194787107178255869 0.57202326590746654933 0.62457965086656230813 0.46709564111859103175 0.36933943047587125541 -0.14724363002810378354 -0.33530180393897568436 -0.50967588908517302837;0.21073037113292206191 -0.50712634284187707578 0.23979997686840970328 0.012471783983435263954 -0.0818439411245645565 -0.51031987709956760924 -0.4595222553463523818 0.092858207818402163647 0.12035530925490373066 -0.26956975264489885236 -0.1365455988444282398 0.55731426530216188198 -0.04657303641543126399 0.6001704275471390071 -0.43578808865768370318 -0.8680819930778269633 0.47911290079514856632 -0.095725812659674835992 0.046487152677587004201 -0.63718348085016685012;-0.23398214520310375852 0.19860577843484614191 0.13828303871350844378 -0.57517113618939896824 -0.80210812588005631074 0.7355245133998128404 -0.41200957065794779899 -0.29954525891444971908 -0.43040657833235484997 0.15165869588203903517 -1.1955080976471161858 -0.44137573768671223284 -1.243506620597518042 -0.71179532735369610563 -0.20958650033439335525 1.0978921969997548214 0.27230537769467677567 -0.61416228766696057129 0.12981003700236809495 -0.048861296998847822404;-0.48124312896863102873 -0.0016072054836072508215 0.21354642644047755473 -0.22899302138044977384 0.22134424594797119656 -0.17190957970873371741 0.14598180682932559993 -0.33570079152743925732 0.41145285965906641668 -0.34981941509993591533 0.3796335558379470565 -0.49415277924711820123 0.2184448561204445638 -0.23990597835261809334 0.35084769502091234239 0.0044708255155385713542 0.11670135244669074814 0.24406268574516909453 0.10714941774213911085 -0.50673037617409233402;-0.35890429181438188166 0.28148448465265452079 -0.55564901661306920211 -0.41651635695940170123 0.47328420353953076782 0.030529602158434452491 0.37562599624218095951 -0.028398799791485979799 -0.45656419934316239129 0.17598560533456808486 0.061381599914507263549 -0.30896133619694837735 0.059557521381623144963 -0.59781203699568119525 -0.57732593638662321744 -0.81749775909834909715 0.48693148704781741287 0.12269617726757058029 0.61665622630702465745 0.20899006089851324131;-0.2490416631726740937 0.51621997482190762341 -0.4109360096109679894 -0.26005622257454957813 0.042464806317595145402 -0.36673348496378460615 0.14298234781626631418 -0.54585885377911547156 0.67787535642604779262 -0.36817607626032988755 -0.65563829126815353909 -0.44705179599243760613 0.33617268268470879011 -0.01939274668656743722 -0.36466749428253991683 0.47199491335094623246 -0.003649096958133538765 -0.27482817726975483641 0.120362292143121552 -0.12484040309337630925;0.54030860638031341647 0.18244511397292331734 -0.017185231119343474804 0.62606924701534116817 -1.1705023228001472102 1.0444527891334742797 0.50375765948035466923 -0.72290983671054442894 -0.85854900045073678783 0.33520696889611506508 0.079208993172659045157 0.20565334774710256061 -0.38625271567531072048 -0.1669626347960888324 0.39180614860311069325 0.26145453994181389046 -0.44149891098565419156 -0.21750516105015418877 -0.11163047139471567182 0.26740890737838940439;-0.28328836707462745625 0.57018202926983407863 0.39745756354717703962 -0.070791468594297288219 -0.32025295652937946222 0.40955036117696352882 0.29442185230539313912 -0.62762812903694487066 -0.50783264916095716135 -0.4363427169220850943 0.35950075821554194899 0.2636825479020429297 -0.23303606963484976844 0.10187720760552937405 0.36886186417769872836 0.0013028795492728113218 -0.18858411649097814311 0.21001760905002608837 -0.43606152589679664233 -0.39320586572174287543;-0.40002731291563137228 -0.52894788627579780727 -0.16275366279017913773 -0.16537239766329628332 0.29703507398820311325 -0.65647695857608745484 -0.59813455481633870381 0.13497299609376173235 0.51713527155451710637 0.37783083688585128446 -0.10945584848984643567 -0.16417396121233474027 -0.26006348072442031505 0.12766123079632704651 -0.25726747538469485477 -1.1730086275580782207 -0.3274673513312718609 -0.56434472520760581293 0.44800819046270001778 -0.24664043418921627326;-0.25747809281182082453 0.32764063480673516482 0.32906076359335689752 0.2829397118056852789 -0.10863891663388176856 -0.10032342913733111045 0.66187251483194775581 0.070084687433188172512 0.3483589852568166334 -0.51412035018648405416 0.15332121371658397058 -0.22842760366488068513 0.37902992655571560165 0.065519388968252004202 0.35955015996845579584 0.16685323806226667886 -0.70999563687758093788 -0.02739503500672497982 0.2330215145993655701 -0.1035179738993582399;-0.10239739940144178265 -0.67908948530291224355 0.40985012062596887228 0.38743675908596447721 0.20169931655799999692 0.71917501397911620664 -0.13277760651515593815 -0.33308828457642652987 -0.032943870128958274712 0.43243929774776568298 -0.13121293603016564999 0.046362055385675102204 -0.30052001477999734647 -0.075541316309803485662 -0.03432322267366335472 -0.75125426413112705859 -0.11521304150441362413 0.35236805133600818118 0.98999075659971191854 -0.19803361038542943717];

% Layer 3
b3 = [-1.6441273817376191868;1.411496908586929111;1.2192720343435212715;0.99733089703653377001;-1.0152397276582594277;-0.62340233703725100867;-0.6239132626979774221;-0.32027922402368286248;0.19181790189417111114;-0.12219930316991693686;0.13889264446204183101;0.33866522409427446405;0.53240141236944293901;0.59775470760217630506;0.75838491587039902342;-0.94841927241405987736;1.0516617857557859494;-1.3946576277823297119;-1.4057523994906691023;1.5974266382719963797];
LW3_2 = [0.39736164917554012144 -0.030932722842388713641 -0.027489994711092643337 -0.02503828491624486216 -0.18379607830987726436 -0.64605925832183341839 -0.19234074822359262247 -0.28411642724573055174 0.10241952120878790311 0.4186222296873012283 -0.054634496201135897275 -0.095753788135249415236 0.62528406190570928747 0.1102845990419431127 0.5206595074419589908 0.58686584749377534997 0.3041483869704094678 0.17260841547336985835 0.60893020048160018121 0.40372701923942327928;0.074312004139600748576 0.021022742980896232806 -0.018282913735465325389 -0.33011055110482018238 -0.6215962273945910832 0.54963094544067137015 -1.3528984296298540713 -0.40342255590062603421 -0.1589984132562798913 0.28913401420764045513 0.34937700026110068974 0.34517219459395431791 -0.026886667115823794511 -0.95567693638325335037 0.044852270262745151663 -0.63194691753160725511 -0.53332487827103902678 0.50868124357035926497 0.066144404473579887505 -0.05800399160624316458;-0.56087009109771435167 -0.57243069905628019001 -0.64158401255578301203 0.41613775681235581905 -0.24098151465313760733 0.26813460100331709679 0.41034650123626076335 -0.38373996638245760904 0.27807814028147070928 0.4421378557302079737 0.22545223113123968872 0.014729236255110455048 0.25308873869191905737 -0.23768963972257775574 -0.48658504501684068932 -0.20417440119138263732 0.56922070206497121792 -0.45380361868378082946 0.29210143180388731254 0.14298248624052317668;-0.76573243109526789585 0.4691155981620188653 -0.49984197082579401306 -0.013836558656730614872 0.16801777005503035212 0.42985044699564567416 -0.28802507761348200566 0.27020217980909522204 -0.53776849654500902265 -0.20607294916602114654 0.61290030420768570885 -0.56326459201262113474 -0.55391550857053639678 0.76357792213711372931 0.58777997572323714692 -0.88619587031091762164 0.028409507602185087027 0.35008294891578844998 0.24636192101791623554 0.3250824232158596172;-0.25797178809944287803 0.3360576604717519511 0.24314507743105362447 -0.44951071902210237852 -0.333213812242314944 -0.058628708816016374128 0.34176922694929634527 0.010688824194241417637 0.051049257009379234162 0.75508044632618287473 -0.24846021663733675044 -0.27825881675271585403 0.70977620142532082959 0.40799432358783943586 -0.086124564220011648463 -0.44472793144100758456 0.051909271831086081783 0.61667602869998783266 -0.49976352971578474893 -0.095258629448929710293;0.64145024401552930282 -0.43325952330863176654 0.18089006158919720968 0.51843972030467688761 -0.74418794428084944492 -0.13733744062323019475 0.60910492369459667827 0.019204343737265261449 0.50163746671094333607 -0.55038099063526424448 0.041466362689688139598 0.46770793585962761041 -0.1633380682424797059 -0.96106258186438897617 -0.57783591537626843859 0.16554953105440750605 -0.41919814700262525431 -0.13034118298639837952 0.50598565018968455487 0.12481858767768112817;0.63235891102652475038 -0.45421366789578193623 0.55935815841024139061 -0.046966104621889791237 0.61710082874598015668 -0.010468668398126294503 -0.19395017865785432742 -0.23285327685138990095 0.62947043241800093583 0.49935859897486206682 0.53371406237754304147 -0.69313152371065200885 0.81432185606358531427 0.14584779738927561299 0.7388432106683422429 -0.13369800120932442966 -0.2004059670335311405 -0.010323364244671919682 -0.14696858544797483659 0.27901834778139850135;0.75268616630265849921 -0.27555128807391565671 0.49400764217477965978 -0.3122019882311620198 -0.21384721735807840637 -0.56824033201845081109 -0.063103305141154489299 -0.02457890024701312251 -0.4926254729161266277 -0.04467325227621481154 -0.41495988898474828188 -0.67346872708686122966 -0.026315761086221169107 -0.087586706431739366763 -0.14859088658888311429 0.35555120422890379439 0.11059395043037939521 0.46070449069813068643 -0.67199539300659272278 0.40121267608903754542;0.34872915223840883492 -0.64765984405642362809 0.35912963270812170435 -0.10167199938596727105 -0.25396895415225562154 0.30028066988682772243 0.78360358695524545691 -0.50058514755871230673 0.64082725199105439184 -0.38238927556540913688 -0.66014565173586803315 -0.63295873189779516821 -0.35789247253012834715 -0.3829384852070490397 0.8889895155052150999 0.27389562257275346102 0.085215584025284576986 -0.31192468843614090668 -0.77383089184752829048 -0.36134850517283784166;0.25896410333452213326 -0.26232850196474133408 -0.5060655632451338537 0.42060648145111878549 0.16457350278808483002 -0.45163569552492627279 -0.44745292972571909518 0.26251710968220764997 -0.50353567568369583807 -0.2406428811894298081 0.26217398747250969526 -0.49320345424401434986 -0.4693429086843435849 -0.04645782274243034915 -0.37781890544543106358 -0.45159178281257728038 0.058876553015218074938 -0.014634414689918393351 0.61855669723593520448 0.23681918400807583369;-0.9012710418508462773 -0.35329374382615696959 0.56074299746671696365 -0.00405413897544531273 -0.15351290571527523299 -0.1148730079176326635 -0.55417576411074465081 0.78066359254230976994 0.54035363021448679088 0.44136250486702854889 -0.67146340723354203117 -0.47862551941608177941 0.32495426727513415655 -0.41682358852281570227 -0.78673193486949943853 -0.49456674143665707577 -0.65318012768995359352 0.4417513948725920736 0.12054069828870261905 0.014648146458983307;0.5853530234411378208 -0.091919345166904697919 -0.41839365543481138454 -0.6800466772017444983 0.20437310312747450358 -0.31456515729635564638 -0.64133319566208379925 -0.30227308361639548817 -0.055366698579537243496 0.22573151745325203965 -0.10888958037135684775 -0.19795061018626297633 -0.33626733490458521336 -0.4877531813638281144 0.53293426951144584613 -0.34721862617678656004 -0.38509201239551821283 0.56656025405432508535 -0.10615361155756711242 -0.51124674002711278931;0.34520132493816069186 0.55253763855575710462 0.16016556205306778371 -0.53297626643052742335 0.18278240199411471822 0.30693986725964234052 -0.42110769791553431807 0.35144613204771540937 -0.65279898559134774683 -0.51220996273367380702 0.052217460103294824347 0.080923465712071443456 0.54669270685477822092 -0.40725092965009485058 0.40466084441204247524 -0.29768960381521436531 0.080391801325693235114 0.32668641257045188953 0.13637465951623406468 -0.2977513926926652621;0.09085547914696258387 0.035905370050080209765 0.045069943179280314016 0.18413825989047336029 0.62269383765598840252 0.089181908525006639565 -0.50127801008377748104 0.52358260926081379161 -0.36094143491255459288 -0.34052970125253334555 -0.12495781672874671508 -0.076487433754565056776 0.71593457750882427693 0.0083878287503536697739 -0.15597778957080693507 -0.58249709138058614055 0.2320389564174870356 -0.47727244056435508268 -0.35246695495489971384 -0.43982512529164780046;-0.15043232601803782633 -0.11577979013186252832 -0.52371877450746640026 -0.035412978403228413671 0.0048313496032961616988 -0.55564658707997738318 0.76642787856376259903 -0.58452753020099335046 0.10807380941246057249 0.38038751330346681767 -0.31994383172866808218 0.30646599307332839102 -0.39236460610899887014 0.10090394347424133659 -0.60967414594018243257 0.53399578631910471493 -0.31970265783967960482 -0.25636832020146932409 0.080246739306039482909 0.48551724540917073902;-0.48532842593400676856 0.63346444002878232737 0.53961717598117209249 -0.3097817606134788404 0.14359441925387034233 0.45527716662107126089 -0.0010730278431273312413 0.26332680611898334755 0.20226670598835053139 0.51403109145037795269 -0.16825395805018897311 0.646028025860075239 -0.20989121167489066533 0.35138997336310850983 -0.053222332099700460362 -0.65962254889152005521 0.35892487428578123687 0.30805043463911285784 -0.26031803715457701998 0.13497197319092119061;0.4925480324380670516 -0.16533092994511441876 0.14792568772064032534 -0.3849764881392555016 0.32762317566534027158 -0.46071407102554279289 0.22762787680524101952 0.58172610594075035984 -0.39489924189984065839 0.44367470235252709498 -0.19248397772398814776 0.43718953880437461113 0.74853032203774549913 0.41982239706246515798 0.099899901650744429848 0.25535128063060696935 -0.33294261147980730442 -0.042776417817362237528 0.041642629511230433437 0.39947479219741754974;-0.50189391387116577548 -0.30700748832013446954 0.13122923374963985088 -0.42073739838749424358 0.28576742042457081716 -0.31986810587011188511 0.17232392265978060952 0.29218491633540255581 -0.38823440603215669809 -0.049170397736341624195 -0.052354824462273200081 0.18454136970959753028 -0.080010340753171163564 -0.091491674803719322262 0.56820022098873590455 -0.43220903285822676043 0.57090329362633296384 0.21533095875903329741 0.62953236795760292299 0.49169891140575860966;-0.097600698239173583337 0.35835454787385456754 -0.097990914668617493111 -0.072858730199403184957 0.004396182474095468827 -0.39002100582662302397 0.3862597138882858383 0.27026181409711508286 -0.39012596209664307523 -0.14115524797243761412 -0.5569119879589917721 -0.16233898052902259734 -0.23377294048706495633 0.70774147883962823524 0.56699096330311915537 0.2046366220464442276 -0.34728408583068143267 0.62845485064939066167 0.26148436010744535718 0.12081043269039830335;0.37703326063892383946 0.25353580823925414567 0.19452643937007332853 -0.38965208550885127581 0.48335838430880756489 0.25317875174017206996 0.75362483572318439418 -0.0095526566834356948371 0.4960679654133635097 -0.37559422759592037133 -0.37303067746555584883 -0.092174408818914879693 -0.61785506403734269387 0.32423153863702502964 0.045689092536457150129 -0.24626860946850751 0.51799620455625605686 -0.35032056126271188257 0.42126109657685367749 0.016343700443186833654];

% Layer 4
b4 = 0.0034586087763820855256;
LW4_3 = [-0.051133668392559582239 0.60295314312413605951 0.27149614884430534056 1.0547803171163638858 -0.93472953540681025242 -1.2710761369352958639 -0.91993722377681719227 -0.41752773578281815459 -1.2661001747433597853 -0.1867401521547729093 -0.75363009050040297154 -0.85148864487412312396 -1.0518372755847504862 -0.0069078959723960350545 0.6072651491631804177 0.59182940063000477604 0.88617890279977318269 0.42243849573481051518 -0.10492448407258077314 0.55200639472316948009];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.382528974555994;
y1_step1.xoffset = -2.61075848464239;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);

% Layer 4
a4 = repmat(b4,1,Q) + LW4_3*a3;

% Output 1
y1 = mapminmax_reverse(a4,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
